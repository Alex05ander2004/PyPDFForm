# 2025-05-24: V3 Announcements

This article contains import information about the upcoming v3.0.0 release.

## TL; DR

PyPDFForm v3.0.0 is tentatively scheduled to be released on June 24, 2025. This major release will contain changes that are backward incompatible. If you do not wish to trigger any downstream regression, pin your version to <=2.5.0 ASAP.

Below is a list of said changes:

* `FormWrapper` is removed. All of its functionalities are migrated to `PdfWrapper`. From now on the `fill` method of `PdfWrapper` will behave just like it did in `FormWrapper`.
* Filling while enabling `adobe_mode` has changed. Now instead of passing `adobe_mode` as a keyword argument to the `fill` method, you pass `adobe_mode` as a keyword argument when instantiating a `PdfWrapper` object.
* Setting font properties globally (e.g., `PdfWrapper("sample_template.pdf", global_font_size=20)`) is not supported anymore. Font properties will now be set through each widget.
* `register_font` is now a object level method instead of a class method.
* `PdfWrapper.preview` is removed.
* Changing `button_style` for existed checkboxes or radio buttons is not supported anymore. (Specifying `button_style` when creating them is still supported)
* Render widgets flag `render_widgets` is removed.

## Why the changes?

About five years ago when I first started working on this project,  I was no where near as experience as today and I stumbled on some technical challenges during the initial POC. One of such challenges was displaying filled text fields in Adobe Acrobat, specifically, text content may only be visible when the text field is selected.

This behavior of Adobe Acrobat, plus I wanted to support as many PDF viewing applications as possible, made me decide to approach the project's implementation through a watermark approach. Basically, instead of directly manipulate the form field data, the watermark approach only collects information about each form field. Such information can be the coordinate of the field, what font, font size, or font color it should be filled with, etc. Once done, it will then remove all form fields, create a watermark based on the PDF, draws the content of what should be filled on the watermark, and finally merge the watermark onto the original PDF. This approach, despite will remove all existed fields and make the filled content appear to be always "flattened", ensures that the filled PDFs only consists raw PDF string data and can be viewed by any PDF viewing applications. The project has since evolved with this approach, adding rich features such as customizing different form field styles and even creating form fields. As I'm writing this article, the watermark approach is still the bare bone of the project in v2.5.0, and that is the `PdfWrapper`.

About a year ago, as more users started using the project, I was assisted by the community and finally able to break through the text field issue on Adobe Acrobat that has existed since the first day of the project. This has made it possible to fill a PDF form by manipulating the form field data directly, which brings a number of advantages such as being able to leave the form fields editable after filling, not having to come up with complex arithmetics for calculating coordinates and resolutions, and not having to merge watermarks with the original PDF which is a huge performance boost. However, the project has evolved too far at this point and some of the features supported by the watermark approach, for example changing font properties, cannot be rewritten using the new approach easily, at least at the time. So instead of completely replacing the watermark approach, I took a step back and decided to implement a new and simpler set of APIs that supports this new filling paradigm. This is the `FormWrapper`.

The addition of `FormWrapper` has proved to be a right move, as even more users are attracted thanks to it being able to truly "fill" a PDF form as if it were filled manually. `PdfWrapper` and `FormWrapper` have co-existed since then. However, several events have occured recently such that new changes, even more major and ground breaking, need to happen to the project in order to adapt. First, I noticed that a lot of users, despite still using some of the features provided by `PdfWrapper` such as creating widgets or change widget names, tend to do the final step of actually filling a PDF form using `FormWrapper`. In these cases I had to suggest them to first do what they need to do using `PdfWrapper`, take the stream from the `PdfWrapper` object, and then feed that into a `FormWrapper` to do the final filling. This process to me seems not quite user friendly. Secondly, I implemented some very complicated arithmetic logics to calculate where and how form field data should be drawn when filling using the watermark approach. But I think I have hit my limit, as I could not figure out how to support landscape mode PDFs due to the orientations. This makes switching off watermark approach even more appealing. Finally, during my recent researches, the features that used to only be possible through the watermark approach, have become more apparent on how to implement through directly manipulating form field data.

With everything above said, I think the time has become mature to implement the next major version of PyPDFForm. This is what v3.0.0 is.

## What are the changes?

In short, the goal of v3.0.0 can be summed up to:

* Merge `FormWrapper` into `PdfWrapper`.
* Reimplemente most, if not all `PdfWrapper` features, especially the `fill` method, using the approach of directly manipulating form field data.
* Preserve as much backward compatibility as possible.

Now, the part about backward compatibility needs some further elaboration. For changes as ground breaking as this release, it is impossible to keep things truly backward compatible. For example, even though you might be calling the `fill` method the same way before and after this release, all of sudden the PDF forms filled become editable due to not using the watermark approach anymore.

So, when I said to preserve as much backward compatibility as possible, what I really meant was as little API changes as possible. That means the outcome of your generated PDFs will be slight different from the watermark approach before, but you will still be calling most of PyPDFForm's APIs the same way as before the release.

However, there are some truly backward incompatible changes that have to be made, which is why this release is a major version bump by the convention defined by Semantic Versioning. In the below list, I will do my best explaining these changes as well as the reasoning behind each of them:

* As described above, `FormWrapper` is migrated into `PdfWrapper` and completely removed. `FormWrapper` only has the most basic functionalities that support filling a PDF form. After the migration the `fill` method of `PdfWrapper` will behave just like it did in `FormWrapper`.
* The parameter `adobe_mode` has been moved from the `fill` method to when instantiating a `PdfWrapper` object. This change is needed because now most features of `PdfWrapper` manipulate form field data and they all need to support Adobe Acrobat. So it is moved to a scope for the entire object rather than just the filling method.
* Font properties used to be able to be set globally per object through parameters like `global_font`, `global_font_size`, and `global_font_color` during instantiation. This is no longer supported and font properties will be set at each individual widget's level from now on. Setting font properties globally used to be intuitive as they all need to apply to the same watermarks. Now because the project manipulates form field directly it is more intuitive to set them at widget level.
* `register_font` is now a object level method instead of a class method. This change should have happened earlier and is only becoming more apparent with this release, as each font registered should only apply to a single PDF form instance.
* Trying to modify the `button_style` of existed checkboxes or radio buttons by manipulating form field data directly is challenging, as it involves some complicated stream creation that I'm not capable of right now. So this feature is removed for now, but may get added back in the future. Note this change does not impact the ability of specifying `button_style` when creating checkboxes or radio buttons.
* `render_widgets` is removed. This feature was origionally implemented to add backward compatibility for when the watermark approach first started supporting rendering widget borders and backgrounds. Since now the watermark approach is gone there's no need to keep this feature anymore.

## What do you need to do?

First and for most, it is strongly recommended that you pin your PyPDFForm dependency version to <=2.5.0 ASAP.

After pining your version, you have couple options:

* If any of the backward incompatible changes apply to your code, consider fixing your code following the guidance provided above.
* If you do not like the new approach of the project and would like to stick with the watermark approach, you can keep your version pinned to <=2.5.0 forever as those past release artifacts will never change.

Otherwise, once the release is made, you should have no problem upgrading to v3.0.0 and any future patches after the release.
